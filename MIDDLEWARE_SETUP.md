# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## ‚úÖ –ß—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

Middleware `UserActivityMiddleware` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ –ª—é–±—ã—Ö API –∑–∞–ø—Ä–æ—Å–∞—Ö.

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ

- **–ü—Ä–∏ –ª—é–±–æ–º API –∑–∞–ø—Ä–æ—Å–µ** —Å `telegramId` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **TTL: 5 –º–∏–Ω—É—Ç** - –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ—Ñ—Ñ–ª–∞–π–Ω
- **–ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–µ –Ω—É–∂–Ω–æ**

### –ì–¥–µ –∏—â–µ—Ç—Å—è telegramId

Middleware –∏—â–µ—Ç `telegramId` –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:

1. `req.headers['x-telegram-id']` - –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –∑–∞–ø—Ä–æ—Å–∞
2. `req.query.telegramId` - –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö URL
3. `req.body.telegramId` - –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞

## üì± –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)

```javascript
// –ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–π—Ç–µ telegramId –≤ –∑–∞–ø—Ä–æ—Å—ã - –±–æ–ª—å—à–µ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ!
fetch('/api/user?telegramId=123456789')
fetch('/api/like', {
	method: 'POST',
	body: JSON.stringify({ telegramId: '123456789', toUserId: '987654321' }),
})
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –° –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏

```javascript
// –î–æ–±–∞–≤–ª—è–π—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ x-telegram-id
fetch('/api/user', {
	headers: {
		'x-telegram-id': '123456789',
	},
})
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ **–û–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** –Ω–µ –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –±–æ—Ç–µ
- ‚úÖ **–û—Ñ—Ñ–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–∞–∫ –æ–±—ã—á–Ω–æ
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –Ω–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ **TTL 5 –º–∏–Ω—É—Ç** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å—Ç–µ—á–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## üîç –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

Middleware –ª–æ–≥–∏—Ä—É–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 123456789 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ –æ–Ω–ª–∞–π–Ω
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 123456789 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ –æ—Ñ—Ñ–ª–∞–π–Ω
```

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ü—Ä–æ—Å—Ç–æ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –≤–∞—à–∏—Ö API –∑–∞–ø—Ä–æ—Å–∞—Ö –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è `telegramId` - –∏ –≤—Å–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
